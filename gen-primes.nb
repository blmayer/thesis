(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12418,        323]
NotebookOptionsPosition[     10634,        284]
NotebookOutlinePosition[     11039,        300]
CellTagsIndexPosition[     10996,        297]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Create list of primes-n", "Section",
 CellChangeTimes->{{3.777320088143992*^9, 
  3.777320096764777*^9}},ExpressionUUID->"aea60b1b-ee95-42d9-ad26-\
1a02e79926e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nprimes", "=", 
   RowBox[{"<|", "|>"}]}], ";"}]], "Input",ExpressionUUID->"3606d7dc-586b-\
4807-8d87-fcc8230c614f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"allPrimes", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"divisors", "=", 
         RowBox[{"Length", "@", 
          RowBox[{"Divisors", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nprimes", "[", "divisors", "]"}], "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Lookup", "[", 
            RowBox[{"nprimes", ",", " ", "divisors", ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", " ", "x"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "1000001", ",", "5000000"}], "}"}]}], "]"}], ";"}], 
    "\[IndentingNewLine]", ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7773201537138042`*^9, 3.777320262739933*^9}, 
   3.777320332785748*^9, {3.777320496118555*^9, 3.777320562244919*^9}, {
   3.7773206849204493`*^9, 3.7773206899427977`*^9}, {3.77732761959566*^9, 
   3.777327620974283*^9}, {3.7773401032100477`*^9, 3.777340129591023*^9}, {
   3.777341845997437*^9, 3.777341846706061*^9}, {3.77737923358594*^9, 
   3.777379242968938*^9}, {3.777486548612125*^9, 3.777486568968515*^9}, {
   3.7879496818145227`*^9, 3.787949689582486*^9}, {3.789392318434721*^9, 
   3.789392350931426*^9}, {3.789394023581029*^9, 3.789394028111495*^9}, 
   3.792796042800061*^9, {3.7927966116358013`*^9, 3.792796621658746*^9}, {
   3.792796651960835*^9, 3.792796751895095*^9}, {3.792799651760375*^9, 
   3.792799651988104*^9}, 3.792874078875502*^9, 3.7928812778075047`*^9, {
   3.7928842822471027`*^9, 3.792884283058803*^9}, {3.793042768015373*^9, 
   3.793042771971921*^9}, {3.793050612812183*^9, 3.7930506304472437`*^9}, {
   3.7933136234138117`*^9, 3.793313626980187*^9}, {3.793399817539443*^9, 
   3.793399818349387*^9}, {3.7934383268917627`*^9, 3.7934383292645483`*^9}, {
   3.793455599672279*^9, 3.793455602883335*^9}, {3.793556473332778*^9, 
   3.793556473649131*^9}, {3.793746506100615*^9, 3.793746510942376*^9}, {
   3.793746645832033*^9, 3.793746648431974*^9}, {3.793747099736444*^9, 
   3.793747104861042*^9}, {3.7937477136258373`*^9, 3.793747721003602*^9}, {
   3.7937984301672373`*^9, 3.7937984361460648`*^9}, {3.793800929141206*^9, 
   3.7938009385750923`*^9}, {3.793803623468462*^9, 3.793803627038916*^9}, {
   3.793808188002387*^9, 3.793808191756915*^9}, {3.794700616386717*^9, 
   3.794700638383115*^9}, {3.7947011930048437`*^9, 3.7947012265027733`*^9}, 
   3.7947015313669863`*^9, {3.794705874909053*^9, 3.794705882687623*^9}, {
   3.794787416169033*^9, 3.7947874272634573`*^9}, {3.79478770527458*^9, 
   3.794787709964953*^9}, {3.794788718543043*^9, 3.794788721568513*^9}, {
   3.889728178249834*^9, 3.8897282866675777`*^9}, {3.889730009320459*^9, 
   3.889730036007388*^9}, {3.889730805898616*^9, 3.889730829997748*^9}, {
   3.889730887059369*^9, 3.889730903504174*^9}, {3.889738039521405*^9, 
   3.889738043773592*^9}, {3.8897380827871532`*^9, 3.889738093173397*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"2db725e5-5d12-4ec6-8766-ea297ee7ac47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{
    RowBox[{"StringJoin", "[", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", 
      "\"\<nprimes.mx\>\""}], "]"}], ",", "nprimes"}], "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.777320344088688*^9, 3.777320378113502*^9}, {
   3.7773205009707212`*^9, 3.777320509132868*^9}, 3.7879496778675213`*^9, {
   3.789392655142415*^9, 3.7893926660986757`*^9}, 3.7893927117263203`*^9, {
   3.792798569629632*^9, 3.792798583522876*^9}, 3.7947911714978523`*^9, {
   3.889738065255982*^9, 3.889738066194072*^9}},
 CellLabel->
  "In[407]:=",ExpressionUUID->"108bb68c-ff15-4ecc-8827-925bfdbf88e4"],

Cell[CellGroupData[{

Cell["Append", "Subsection",
 CellChangeTimes->{{3.777381394116784*^9, 3.77738140291335*^9}, {
  3.793556201433218*^9, 3.793556202882316*^9}, {3.890563981625175*^9, 
  3.8905639827052526`*^9}},ExpressionUUID->"82fabff7-d846-430c-b5f1-\
d0350efdfba3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"divisors", "=", 
        RowBox[{"Length", "@", 
         RowBox[{"Divisors", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"nprimes", "[", "divisors", "]"}], "=", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Lookup", "[", 
           RowBox[{"nprimes", ",", " ", "divisors", ",", 
            RowBox[{"{", "}"}]}], "]"}], ",", " ", "x"}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"Max", "@", "nprimes"}], "+", "1"}], ",", 
        RowBox[{
         RowBox[{"Max", "@", "nprimes"}], "+", "3000000"}]}], "}"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.890563997342821*^9, 3.8905640156929913`*^9}, {
  3.8922544539970207`*^9, 3.8922544577996264`*^9}},
 CellLabel->
  "In[377]:=",ExpressionUUID->"fdcb4c76-03e5-4ddc-921b-3e8f5c87631c"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.892295747540797*^9},
 CellLabel->
  "Out[377]=",ExpressionUUID->"4bb9d978-96a7-4ff8-80c4-94441be824de"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"Divisors", "[", "#", "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    RowBox[{"nprimes", "[", "16", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{"10000", ",", "1000"}], "]"}], "]"}], "]"}]}], "//", 
  "Union"}]], "Input",
 CellChangeTimes->{{3.890611252653977*^9, 3.890611260709313*^9}, {
  3.8922959170174627`*^9, 3.892295928828017*^9}, {3.89229639401297*^9, 
  3.892296492841528*^9}},
 CellLabel->
  "In[406]:=",ExpressionUUID->"814a5966-9fbc-40c8-8db6-32b34fa1de4a"],

Cell[BoxData[
 RowBox[{"{", "16", "}"}]], "Output",
 CellChangeTimes->{
  3.892295929653598*^9, 3.892296101351697*^9, 3.892296190778317*^9, {
   3.892296426264035*^9, 3.892296445368658*^9}, {3.89229647704823*^9, 
   3.8922964934274797`*^9}},
 CellLabel->
  "Out[406]=",ExpressionUUID->"84fe0434-bf19-4064-bcac-8025b96eea47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Divisors", "@", "5000000"}], "//", "Length"}]], "Input",
 CellChangeTimes->{{3.890611143849092*^9, 3.8906111592093573`*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"4ae2f1a9-79a5-4233-895f-aa84437ea39c"],

Cell[BoxData["56"], "Output",
 CellChangeTimes->{{3.890611149783868*^9, 3.8906111595488586`*^9}},
 CellLabel->
  "Out[261]=",ExpressionUUID->"8c98ff61-0e42-4760-a9ef-e853360e3678"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Shortcut for n prime", "Subsection",
 CellChangeTimes->{{3.777381394116784*^9, 3.77738140291335*^9}, {
   3.793556201433218*^9, 3.793556202882316*^9}, 
   3.892295794097794*^9},ExpressionUUID->"1aa7ad98-c75d-4f4d-ac0f-\
0f07813b89dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "@", "primes"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"primes", "[", 
   RowBox[{"n_", ",", " ", "l_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prime", "[", "x", "]"}], "^", 
      RowBox[{"(", 
       RowBox[{"n", "-", "1"}], ")"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "l"}], "}"}]}], "]"}], "/;", 
   RowBox[{"OddQ", "[", "n", "]"}]}]}]}], "Code",
 CellChangeTimes->{{3.777381418002802*^9, 3.777381456651602*^9}, {
  3.777381572020906*^9, 3.777381591344284*^9}, {3.777381656383456*^9, 
  3.777381666331197*^9}, {3.7773817180861*^9, 3.777381727395719*^9}, {
  3.7774865291691008`*^9, 3.777486530576468*^9}, {3.892295830418173*^9, 
  3.8922958309419823`*^9}},ExpressionUUID->"a51b9d0e-5cb3-4c89-96c2-\
d7bbf7c5877b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nprimes", "[", "3", "]"}], "=", 
   RowBox[{"primes", "[", 
    RowBox[{"3", ",", "10000"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nprimes", "[", "5", "]"}], "=", 
   RowBox[{"primes", "[", 
    RowBox[{"5", ",", "10000"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nprimes", "[", "7", "]"}], "=", 
   RowBox[{"primes", "[", 
    RowBox[{"7", ",", "10000"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nprimes", "[", "11", "]"}], "=", 
   RowBox[{"primes", "[", 
    RowBox[{"11", ",", "10000"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nprimes", "[", "13", "]"}], "=", 
   RowBox[{"primes", "[", 
    RowBox[{"13", ",", "10000"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8906715667244167`*^9, 3.890671584050357*^9}, {
  3.89229584485693*^9, 3.892295883018264*^9}},
 CellLabel->
  "In[383]:=",ExpressionUUID->"1262aee8-807d-42ac-84af-fdd89cff750d"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1546.5, 1064.25},
WindowMargins->{{0.75, Automatic}, {0.75, Automatic}},
FrontEndVersion->"12.2 for Linux x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4e83245e-ca4d-4050-9905-8a359a200fb6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 168, 3, 68, "Section",ExpressionUUID->"aea60b1b-ee95-42d9-ad26-1a02e79926e4"],
Cell[751, 27, 151, 4, 29, "Input",ExpressionUUID->"3606d7dc-586b-4807-8d87-fcc8230c614f"],
Cell[905, 33, 3860, 75, 154, "Input",ExpressionUUID->"2db725e5-5d12-4ec6-8766-ea297ee7ac47"],
Cell[4768, 110, 673, 15, 29, "Input",ExpressionUUID->"108bb68c-ff15-4ecc-8827-925bfdbf88e4"],
Cell[CellGroupData[{
Cell[5466, 129, 250, 4, 54, "Subsection",ExpressionUUID->"82fabff7-d846-430c-b5f1-d0350efdfba3"],
Cell[CellGroupData[{
Cell[5741, 137, 1124, 29, 133, "Input",ExpressionUUID->"fdcb4c76-03e5-4ddc-921b-3e8f5c87631c"],
Cell[6868, 168, 160, 3, 33, "Output",ExpressionUUID->"4bb9d978-96a7-4ff8-80c4-94441be824de"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7065, 176, 589, 16, 29, "Input",ExpressionUUID->"814a5966-9fbc-40c8-8db6-32b34fa1de4a"],
Cell[7657, 194, 324, 7, 33, "Output",ExpressionUUID->"84fe0434-bf19-4064-bcac-8025b96eea47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8018, 206, 242, 5, 29, "Input",ExpressionUUID->"4ae2f1a9-79a5-4233-895f-aa84437ea39c"],
Cell[8263, 213, 180, 3, 33, "Output",ExpressionUUID->"8c98ff61-0e42-4760-a9ef-e853360e3678"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8492, 222, 240, 4, 54, "Subsection",ExpressionUUID->"1aa7ad98-c75d-4f4d-ac0f-0f07813b89dd"],
Cell[8735, 228, 834, 21, 72, "Code",ExpressionUUID->"a51b9d0e-5cb3-4c89-96c2-d7bbf7c5877b"],
Cell[9572, 251, 1034, 29, 113, "Input",ExpressionUUID->"1262aee8-807d-42ac-84af-fdd89cff750d"]
}, Open  ]]
}, Open  ]]
}
]
*)

